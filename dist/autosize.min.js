!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e||self).autosize=t()}(this,function(){var e="function"==typeof ResizeObserver&&"function"==typeof WeakMap,t=e?new WeakMap:new Map,o=function(){if(e)return new ResizeObserver(function(e){return e.forEach(function(e){return r(e.target)})});var o=function(){return t.forEach(function(e,t){return r(t)})};return window.addEventListener("resize",o),{observe:function(){},unobserve:function(){},disconnect:function(){return window.removeEventListener("resize",o)}}}();function n(e){return e.width+"-"+e.height+"-"+e.padding+"-"+e.borderWidth+"-"+e.overflow+"-"+e.boxSizing+"-"+e.textAlign}function r(e){var o=t.get(e);void 0!==o&&e.scrollHeight>0&&n(o.computed)!==o.previousStyles&&o.update()}function i(e){var o=t.get(e);o&&o.destroy()}function l(e){var o=t.get(e);o&&o.update()}var s=null;return"undefined"==typeof window?((s=function(e){return e}).destroy=function(e){return e},s.update=function(e){return e}):((s=function(e,r){return e&&Array.prototype.forEach.call(e.length?e:[e],function(e){return function(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName&&!t.has(e)){var r,i=null,l=null,s=window.getComputedStyle(e),u=(r=e.value,function(){d({testForHeightReduction:""===r||!e.value.startsWith(r),restoreTextAlign:null}),r=e.value}),a=function(n){e.removeEventListener("autosize:destroy",a),e.removeEventListener("autosize:update",c),e.removeEventListener("input",u),Object.keys(n).forEach(function(t){return e.style[t]=n[t]}),t.delete(e),o.unobserve(e)}.bind(e,{height:e.style.height,resize:e.style.resize,textAlign:e.style.textAlign,overflowY:e.style.overflowY,overflowX:e.style.overflowX,wordWrap:e.style.wordWrap});e.addEventListener("autosize:destroy",a),e.addEventListener("autosize:update",c),e.addEventListener("input",u),o.observe(e),e.style.overflowX="hidden",e.style.wordWrap="break-word",t.set(e,{destroy:a,update:c,get previousStyles(){return l},computed:s}),c()}function d(t){var o=t.restoreTextAlign,r=void 0===o?null:o,u=t.testForHeightReduction,a=void 0===u||u,c=s.overflowY;if(0!==e.scrollHeight){"vertical"===s.resize?e.style.resize="none":"both"===s.resize&&(e.style.resize="horizontal");var f,p,h=getParentOverflows(e),v=document.documentElement&&document.documentElement.scrollTop,g=e.scrollHeight;if(e.style.height="",e.style.height=g+heightOffset+"px",clientWidth=e.clientWidth,h.forEach(function(e){e.node.scrollTop=e.scrollTop}),v&&(document.documentElement.scrollTop=v),a&&(f=function(e){for(var t=[];e&&e.parentNode&&e.parentNode instanceof Element;)e.parentNode.scrollTop&&t.push([e.parentNode,e.parentNode.scrollTop]),e=e.parentNode;return function(){return t.forEach(function(e){var t=e[0],o=e[1];t.style.scrollBehavior="auto",t.scrollTop=o,t.style.scrollBehavior=null})}}(e),e.style.height=""),p="content-box"===s.boxSizing?e.scrollHeight-(parseFloat(s.paddingTop)+parseFloat(s.paddingBottom)):e.scrollHeight+parseFloat(s.borderTopWidth)+parseFloat(s.borderBottomWidth),"none"!==s.maxHeight&&p>parseFloat(s.maxHeight)?("hidden"===s.overflowY&&(e.style.overflow="scroll"),p=parseFloat(s.maxHeight)):"hidden"!==s.overflowY&&(e.style.overflow="hidden"),e.style.height=p+"px",r&&(e.style.textAlign=r),f&&f(),i!==p&&(e.dispatchEvent(new Event("autosize:resized",{bubbles:!0})),i=p),c!==s.overflow&&!r){var y=s.textAlign;"hidden"===s.overflow&&(e.style.textAlign="start"===y?"end":"start"),d({restoreTextAlign:y,testForHeightReduction:!0})}l=n(s)}}function c(){d({testForHeightReduction:!0,restoreTextAlign:null})}}(e)}),e}).destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],i),e},s.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],l),e}),s});
